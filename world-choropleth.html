<!doctype html>
    <head>
        <meta charset="utf-8">
        <title>Tourism expenditure over the years (1995-2014)</title>
        <link href="//netdna.bootstrapcdn.com/bootstrap/3.1.1/css/bootstrap.min.css" rel="stylesheet">
        <link href="//netdna.bootstrapcdn.com/font-awesome/4.0.3/css/font-awesome.min.css" rel="stylesheet">
        <link href="css/d3.geomap.css" rel="stylesheet">
        </head>
    <body>
        <div class="container" id="main">
            <h1 class="pull-left">Tourism expenditure over the years (1995-2014)</h1>
            <div class="pull-right" style="margin-top: 1.5em;">
                <select class="form-control" id="map-select">
                    <option value="2014">2014</option>
                    <option value="2013">2013</option>
                    <option value="2012">2012</option>
                    <option value="2011">2011</option>
                    <option value="2010">2010</option>
                    <option value="2009">2009</option>
                    <option value="2008">2008</option>
                    <option value="2007">2007</option>
                    <option value="2006">2006</option>
                    <option value="2005">2005</option>
                    <option value="2004">2004</option>
                    <option value="2003">2003</option>
                    <option value="2002">2002</option>
                    <option value="2001">2001</option>
                    <option value="2000">2000</option>
                    <option value="1999">1999</option>
                    <option value="1998">1998</option>
                    <option value="1997">1997</option>
                    <option value="1996">1996</option>
                    <option value="1995">1995</option>
                </select>
            </div>
            <div id="map"></div>
            <p>Data source: <a href="https://knoema.com/WTODB2016/world-tourism-organization-database-2016">World Tourism Organization Database 2016</a></p>
        </div>
        <script src="node_modules/d3/d3.min.js"></script>
        <script src="node_modules/d3-geo-projection/d3.geo.projection.min.js"></script>
        <script src="node_modules/topojson/build/topojson.js"></script>
        <script src="js/d3.geomap.js"></script>
        <script>
            var worldmap = d3.geomap.choropleth()
                .geofile('topojson/world/countries.json')
                .colors(colorbrewer.YlOrRd[9])
                .column('2014')
                .duration(500)
                .format(d3.format(',.02f'))
                .legend(true)
                .postUpdate(annotation);

            d3.csv('data/tourism_expenditure.csv', function(error, data) {
                d3.select("#map")
                    .datum(data)
                    .call(worldmap.draw, worldmap);
            });

            d3.select('#map-select').on('change', function() {
                worldmap.column(this.value).update()
            });

            function annotation() {
                var anno_height = 60;

                // Remove possibly existing annotation, when map is updated.
                worldmap.svg.selectAll('g.annotation').remove();

                fg = worldmap.svg.append('g')
                    .attr('class', 'annotation')
                    .attr('width', '100%')
                    .attr('height', anno_height)
                    .attr('transform', 'translate(0,' + (worldmap.height() - anno_height) + ')')

            }

        </script>
    </body>
</html>